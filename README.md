# k8s-imgbuild



通过kubeadm部署k8s集群，在执行kubeadm init命令时，默认生成的manifests文件夹下yaml文件的镜像都是gcr.io上的，在国内由于被墙而不能正常下载，也就导致了集群不能正常安装。

**解决办法：** 购买vpn 或者通过阿里云的容器镜像服务镜像构建。

# Step 1

首先在github创建一个repository，创建好后然后git clone到本地，并在本地创建所需下载的镜像dockerfile，这里本地的目录层级为 镜像名称->版本号->dockerfile。创建之后再把所有的文件push到github仓库。最后的结果如下：







# Step 2

登录阿里云的容器镜像服务网址https://www.aliyun.com/product/acr，进入管理控制台，在容器镜像服务->镜像列表->创建镜像仓库，按照要求填写相关信息，示例如下

**进入阿里云容器镜像服务控制台：**

![1588294259382](assets/1588294259382.png)

**创建自己的命名空间：**

![1588294354322](assets/1588294354322.png)



**创建镜像仓库：**

![1588294478944](assets/1588294478944.png)



![1588294551294](assets/1588294551294.png)



![1588294628372](assets/1588294628372.png)



**添加构建规则：**

![1588294702747](assets/1588294702747.png)



![1588294997841](assets/1588294997841.png)



**立即构建：**

![1588294880197](assets/1588294880197.png)

构建日志











